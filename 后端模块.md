用户在线状态维护：当用户在线时，记录保存用户的在线状态、IP地址、端口号。
用户消息列表实时发放：由监听函数将操作实时加入到执行函数列表中递归执行。
向用户发送其好友列表的在线离线情况，包括好友用户名、IP地址、端口号。并按照最后发消息的时间对好友消息列表进行排序。
图表

type 类型判断是 subscribe 收录(添加好友)
用户在线状态的保存
let userMap = new Map()

koa2 服务器

1. users表：用户信息表，存储用户基本信息，包括用户ID(_id)、用户名(account)、手机号(phone)、电子邮箱(email)、用户登录IP地址(ip)、用户登录端口(port)
   
| 名称   |	数据类型	  | 主键	| 是否唯一	| 是否为空	| 备注 |
| ------ | ------ | ------ | ------ | ------ | ------ |
| _id	   | INTEGER	  | Y	    |  Y      |N	      | 用户id |
| account|string  | N	    |  N	    |N	      | 用户名|
| phone	 | Istring| N	    |  N      |N	      | 手機號|
| email|	string	N	   |  N	    |Y	       |郵箱|
| ip|	string	| N	   |  N	    |N	       | IP|

2. chat_friend_ships 表：存储用户的好友信息，包括用户id(from_user_id)、好友id(to_user_id)、加好友请求是否接受(accepted)
   
名称	| 数据类型	| 主键	| 是否唯一	| 是否为空	| 备注 |
| ------ | ------ | ------ | ------ | ------ | ------ |
| from_user_id	| INTEGER |	Y |	Y	| N	| 本人ID|
| to_user_id	| INTEGER	| N	| Y	| N	| 好友ID|
| accept	| BOOLEAN	| N	| N | 	N |	接受状态|

3. chat_history表：存储好友的聊天记录，包括发送方ID(user_id)、接收方(target_id)ID(target_type)、聊天数据(data)(BLOB类型存储二进制大对象，可以实现文件数据的直接存储)，
   sent(用于标识消息是否已发送，若未发送，先存储这个操作，在某一次事件再次触发时检查标志位，操作服务端再次控制client.socket发送消息)。

 | 名称        | 数据类型 | 主键 | 是否唯一 | 是否为空 | 备注              |
| ----------- | -------- | ---- | -------- | -------- | ----------------- |
 | _id          | INTEGER  | Y    | Y        | N        | 消息ID            |
 | user_id     | INTEGER  | N    | N        | N        | 用户ID            |
 | target_id   | INTEGER  | N    | N        | N        | 消息目标ID        |
 | target_type | TEXT     | N    | N        | N        | 目标类型：群/用户 |
 | data        | BLOB     | N    | N        | N        | 消息体            |
 | sent        | BOOLEAN  | N    | N        | N        | 发送是否成功      |
